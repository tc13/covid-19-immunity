lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
legend(x=c(as.Date("2020-12-26"),as.Date("2021-01-16")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
axis(1, at=as.Date(xlabs))
axis(1, at=as.Date(xlabs), labels = xlabs)
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
lines(ag75$cum_dose~ag75$date, col="darkblue", lwd=1.4)
lines(ag70$cum_dose~ag70$date, col="darkgreen", lwd=1.4)
lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-26"),as.Date("2021-01-16")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = xlabs)
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
xlim=c(as.Date("2021-01-01","2021-04-01")),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
xlim=c(as.Date("2021-01-01"),as.Date("2021-04-01")),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
lines(ag75$cum_dose~ag75$date, col="darkblue", lwd=1.4)
lines(ag70$cum_dose~ag70$date, col="darkgreen", lwd=1.4)
lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-26"),as.Date("2021-01-16")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = xlabs)
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
xlim=c(as.Date("2020-12-20"),as.Date("2021-04-01")),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
lines(ag75$cum_dose~ag75$date, col="darkblue", lwd=1.4)
lines(ag70$cum_dose~ag70$date, col="darkgreen", lwd=1.4)
lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-26"),as.Date("2021-01-16")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = xlabs)
axis(1, at=as.Date(xlabs), labels = c("Jan 21", "Feb 21", "March 21", "April 21"))
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-26"),as.Date("2021-01-16")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = c("Jan 21", "Feb 21", "March 21", "April 21"))
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
xlim=c(as.Date("2020-12-20"),as.Date("2021-04-01")),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
lines(ag75$cum_dose~ag75$date, col="darkblue", lwd=1.4)
lines(ag70$cum_dose~ag70$date, col="darkgreen", lwd=1.4)
lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-26"),as.Date("2021-01-16")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = c("Jan 21", "Feb 21", "March 21", "April 21"))
axis(2, las=2)
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
xlim=c(as.Date("2020-12-20"),as.Date("2021-04-01")),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
lines(ag75$cum_dose~ag75$date, col="darkblue", lwd=1.4)
lines(ag70$cum_dose~ag70$date, col="darkgreen", lwd=1.4)
lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-22"),as.Date("2021-01-14")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = c("Jan 21", "Feb 21", "March 21", "April 21"))
axis(2, las=2)
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
xlim=c(as.Date("2020-12-20"),as.Date("2021-04-01")),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
lines(ag75$cum_dose~ag75$date, col="darkblue", lwd=1.4)
lines(ag70$cum_dose~ag70$date, col="darkgreen", lwd=1.4)
lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-21"),as.Date("2021-01-13")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = c("Jan 21", "Feb 21", "March 21", "April 21"))
axis(2, las=2)
pdf("Desktop/vaccinate-cumulative.pdf",height=8, width=6)
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
xlim=c(as.Date("2020-12-20"),as.Date("2021-04-01")),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
lines(ag75$cum_dose~ag75$date, col="darkblue", lwd=1.4)
lines(ag70$cum_dose~ag70$date, col="darkgreen", lwd=1.4)
lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-20"),as.Date("2021-01-13")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = c("Jan 21", "Feb 21", "March 21", "April 21"))
axis(2, las=2)
dev.off()
pdf("Desktop/vaccinate-cumulative.pdf",height=6, width=8)
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
xlim=c(as.Date("2020-12-20"),as.Date("2021-04-01")),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
lines(ag75$cum_dose~ag75$date, col="darkblue", lwd=1.4)
lines(ag70$cum_dose~ag70$date, col="darkgreen", lwd=1.4)
lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-20"),as.Date("2021-01-13")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = c("Jan 21", "Feb 21", "March 21", "April 21"))
axis(2, las=2)
dev.off()
pdf("Desktop/vaccinate-cumulative.pdf",height=5, width=7)
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
xlim=c(as.Date("2020-12-20"),as.Date("2021-04-01")),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
lines(ag75$cum_dose~ag75$date, col="darkblue", lwd=1.4)
lines(ag70$cum_dose~ag70$date, col="darkgreen", lwd=1.4)
lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-20"),as.Date("2021-01-13")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = c("Jan 21", "Feb 21", "March 21", "April 21"))
axis(2, las=2)
dev.off()
pdf("Desktop/vaccinate-cumulative.pdf",height=5, width=6.5)
with(ag80, plot(cum_dose~date, type="l", ylim=c(0,1),
xlim=c(as.Date("2020-12-20"),as.Date("2021-04-01")),
ylab="Cumulative prop. with 1 or 2 doses", axes=F,
xlab="Date (week ending)", col="red", lwd=1.4))
lines(ag75$cum_dose~ag75$date, col="darkblue", lwd=1.4)
lines(ag70$cum_dose~ag70$date, col="darkgreen", lwd=1.4)
lines(ag65$cum_dose~ag65$date, col="purple", lwd=1.4)
lines(ag60$cum_dose~ag60$date, col="darkorange", lwd=1.4)
xlabs <- c("2021-01-01", "2021-02-01", "2021-03-01", "2021-04-01")
legend(x=c(as.Date("2020-12-20"),as.Date("2021-01-13")),
y=c(0.58,1),
title="Age group",
legend=c("80+", "75-79", "70-74", "65-69", "60-64"),
col=c("red","darkblue", "darkgreen", "purple","darkorange"),
cex=0.9, y.intersp=1, lty=rep(1,5), title.adj=0.3,
xjust=0, lwd=1.4)
axis(1, at=as.Date(xlabs), labels = c("Jan 21", "Feb 21", "March 21", "April 21"))
axis(2, las=2)
dev.off()
rm(list=ls())
#Packages
library(rstan)
library(lubridate)
library(dplyr)
#Read data
v <- read.csv("Google Drive/coronavirus/vaccination/VaccineByAge_England.csv")
#New columns
v$England.population.ONS.[v$Age_group=="under 50"] <- 25051209 #Under 16-49 pop size
v$cum_1dose <- v$Cumulative_vaccinations.1st.dose./v$England.population.ONS.
v$date <- dmy(v$Week_end_day)
#Reduce data.frame
age_groups <- c("80+","75-79","70-74","65-69","60-64","55-59","50-54","under 50")
vdf <- v[v$Age_group %in% age_groups,c("Age_group","date","cum_1dose","Cumulative_vaccinations.1st.dose.")]
colnames(vdf) <- c("age_group","date","cum_1dose_prop","cum_1dose_abs")
#zero values
zero.df <- data.frame(
age_group=c("80+","75-79","70-74","65-69","60-64","55-59","50-54","under 50"),
date=c("2020-12-06","2021-01-17","2021-01-17","2021-02-14","2021-02-28","2021-03-07","2021-03-14","2021-03-21"),
cum_1dose_prop=rep(0,8), cum_1dose_abs=rep(0,8))
v.dat <- rbind(vdf,zero.df)
v.dat$age_group_id <- match(v.dat$age_group, age_groups)
#Variables for model
N <- c()
for(i in 1:length(age_groups)){
indx = which(v$Age_group==age_groups[i])
N[i] = v$England.population.ONS.[min(indx)]
}
v.dat.ord <- v.dat[order(v.dat$age_group_id, v.dat$date),]
obs = times = list()
for(i in 1:length(age_groups)){
indx = which(v.dat.ord$age_group==age_groups[i])
obs[[i]] = N[i] - v.dat.ord$cum_1dose_abs[indx]
weak = v.dat.ord$date[indx]
time.seq = seq.Date(from=min(weak), to=max(weak),by="week")
times[[i]] = match(weak, time.seq)
}
#Data in list
y=unlist(obs)
data <- list(M=nrow(v.dat.ord),
y=ifelse(y<0,0,y),
groups=length(age_groups),
group_id=v.dat.ord$age_group_id,
N=N,
t=unlist(times))
#Stan model
v.mod <- stan("Google Drive/coronavirus/vaccination/vaccine-exp.stan",
data=data, refresh=100,
iter=3000, chains=4, cores=4, verbose=T)
plot(v.mod, pars=c("theta"))
post <- extract(v.mod)
apply(exp(post$theta), 2, mean)
post <- extract(v.mod)
apply(exp(post$theta), 2, mean)
v.mod
#Stan model
v.mod <- stan("Google Drive/coronavirus/vaccination/vaccine-exp.stan",
data=data, refresh=100,
iter=6000, chains=4, cores=4, verbose=T)
plot(v.mod, pars=c("theta"))
post <- extract(v.mod)
apply(exp(post$theta), 2, mean)
v.mod
apply(exp(post$theta), 2, mean)
###########################################
## SARS-CoV-2 Natural history parameters ##
###########################################
R0 <- 4.0                       #Basic reproduction number (in the absense of interventions) Flaxman et al. 2020 Nature. https://doi.org/10.1038/s41586-020-2405-7
sigma_recip <- 4.5              #Average duration of latent period (days)     [From He, X., et al. Temporal dynamics in viral shedding and transmissibility of COVID-19. Nat Med (2020). https://doi.org/10.1038/s41591-020-0869-5]
gamma_recip <- 3.1              #Average duration of infectiousness (days)    [From He, X., et al.]
m <- 4                          #Shape paremeter, latent period
n <- 2                          #Shape parameter, infectious period
p_hosp <- c(0.001, 0.001, 0.003, 0.003, 0.012, 0.012, 0.032, 0.032, 0.049, 0.049, 0.102, 0.102, 0.166, 0.166, 0.26) #From Ferguson et al. Report 9
phi <- c(rep(0.75, 4),rep(0.5,11))  #proportion asymtomatic | infection by age group
crs <- 0.4                          #children relative susceptibility
ari <- 0.5                          #asymtomatic relative infectiousness
susceptibility <- c(rep(crs, 4), rep(1, 11))
#Intervention variables
start_days <- c()
interventions_lengths <- c()
R_values  <- c()
contact_interventions <- list()
#vaccination
vaccine_immune <- 365
vaccine_shape <- 2
lockdown_day <- 20      #days after simulation lockdown starts
start_date <- as.Date(date_UK_lockdown)-lockdown_day
#####################
## Time  variables ##
#####################
dt <- 0.01                 #time step = 1/100 days
days <- 365*2              #number of days
time <- seq(0, days, 1)
date_UK_lockdown <- "2020-03-23"
lockdown_day <- 20      #days after simulation lockdown starts
start_date <- as.Date(date_UK_lockdown)-lockdown_day
hour_period <- 24
dates <- seq(ymd(start_date),ymd(start_date+days), by = as.difftime(hours(hour_period)))
start_date
#####################
## Time  variables ##
#####################
start_date <- "2020-03-03"
#####################
## Time  variables ##
#####################
sim_start_date <- "2020-03-03"
UK_lockdown_1 <- "2020-03-23"
UK_lockown_2 <- "2020-10-31"
UK_lockdown_3 <- "2021-01-06"
sim_dates <- seq.Date(from=sim_start_date, to=sim_start_date+days,by="day")
sim_dates <- seq.Date(from=as.Date(sim_start_date), to=as.Date(sim_start_date)+days,by="day")
sim_dates
sim_end_date <- max(sim_dates)
match(lockdown_1_start, sim_dates)
#lockdown dates
lockdown_1_start <- "2020-03-23"
lockdown_1_end <- "2020-06-15"
lockown_2_start <- "2020-10-31"
lockown_2_end <- "2020-12-02"
lockdown_3_start <- "2021-01-06"
lockdown_3_end <- "2021-04-12"
###################
## Interventions ##
##################
start_days <- match(lockdown_1_start, sim_dates)
match(lockdown_1_start, sim_dates)
#lockdown dates
lockdown_1_start <- as.Date("2020-03-23")
lockdown_1_end <- as.Date("2020-06-15")
lockown_2_start <- as.Date("2020-10-31")
lockown_2_end <- as.Date("2020-12-02")
lockdown_3_start <- as.Date("2021-01-06")
lockdown_3_end <- as.Date("2021-04-12")
###################
## Interventions ##
##################
start_days <- match(lockdown_1_start, sim_dates)
start_days
###################
## Interventions ##
##################
start_days <- match(c(lockdown_1_start,lockdown_2_start, lockdown_3_start), sim_dates)
#lockdown dates
lockdown_1_start <- as.Date("2020-03-23")
lockdown_1_end <- as.Date("2020-06-15")
lockown_2_start <- as.Date("2020-10-31")
lockown_2_end <- as.Date("2020-12-02")
lockdown_3_start <- as.Date("2021-01-06")
lockdown_3_end <- as.Date("2021-04-12")
###################
## Interventions ##
##################
start_days <- match(c(lockdown_1_start, lockdown_2_start, lockdown_3_start), sim_dates)
#lockdown dates
lockdown_1_start <- as.Date("2020-03-23")
lockdown_1_end <- as.Date("2020-06-15")
lockdown_2_start <- as.Date("2020-10-31")
lockown_2_end <- as.Date("2020-12-02")
lockdown_3_start <- as.Date("2021-01-06")
lockdown_3_end <- as.Date("2021-04-12")
###################
## Interventions ##
##################
start_days <- match(c(lockdown_1_start, lockdown_2_start, lockdown_3_start),sim_dates)
start_days
c(lockdown_1_end-lockdown_1_start)
library(lubridate)
interventions_lengths
interventions_lengths <- days(lockdown_1_end-lockdown_1_start)
days(lockdown_1_end-lockdown_1_start)
interventions_lengths <- c(days(lockdown_1_end-lockdown_1_start), days(lockdown_2_end-lockdown_2_start), days(lockdown_3_end-lockdown_3_start))
#lockdown dates
lockdown_1_start <- as.Date("2020-03-23")
lockdown_1_end <- as.Date("2020-06-15")
lockdown_2_start <- as.Date("2020-10-31")
lockdown_2_end <- as.Date("2020-12-02")
lockdown_3_start <- as.Date("2021-01-06")
lockdown_3_end <- as.Date("2021-04-12")
###################
## Interventions ##
##################
start_days <- match(c(lockdown_1_start, lockdown_2_start, lockdown_3_start),sim_dates)
interventions_lengths <- c(days(lockdown_1_end-lockdown_1_start), days(lockdown_2_end-lockdown_2_start), days(lockdown_3_end-lockdown_3_start))
interventions_lengths
interventions_lengths[1]
interventions_lengths[1]+1
interventions_lengths[1]
days(interventions_lengths[1])
interventions_lengths[1]
as.numeric(interventions_lengths[1])
detach("package:lubridate", unload = TRUE)
##########################
## Vaccine rates - Stan ##
##########################
rm(list=ls())
###########################################
## SARS-CoV-2 Natural history parameters ##
###########################################
R0 <- 4.0                       #Basic reproduction number (in the absense of interventions) Flaxman et al. 2020 Nature. https://doi.org/10.1038/s41586-020-2405-7
sigma_recip <- 4.5              #Average duration of latent period (days)     [From He, X., et al. Temporal dynamics in viral shedding and transmissibility of COVID-19. Nat Med (2020). https://doi.org/10.1038/s41591-020-0869-5]
gamma_recip <- 3.1              #Average duration of infectiousness (days)    [From He, X., et al.]
m <- 4                          #Shape paremeter, latent period
n <- 2                          #Shape parameter, infectious period
p_hosp <- c(0.001, 0.001, 0.003, 0.003, 0.012, 0.012, 0.032, 0.032, 0.049, 0.049, 0.102, 0.102, 0.166, 0.166, 0.26) #From Ferguson et al. Report 9
phi <- c(rep(0.75, 4),rep(0.5,11))  #proportion asymtomatic | infection by age group
crs <- 0.4                          #children relative susceptibility
ari <- 0.5                          #asymtomatic relative infectiousness
susceptibility <- c(rep(crs, 4), rep(1, 11))
#vaccination
vaccine_immune <- 365
vaccine_shape <- 2
############################
## Intervention variables ##
############################
Rt_lockdown <- 0.8              #Effective reproduction number during lockdown (full intervention)
Rt_partial <- 1.2               #Effective reproduction number at start of lockdown in tpi period
intervention_post_lockdown <- c(home=1,work=0.8,school=0.85, other=0.75)    #Scaling of contact matrix during partial intervention period
intervention_full <- c(home=0.8,work=0.3,school=0.1,other=0.2)        #Scaling of contact matrix during full intervention period
#####################
## Time  variables ##
#####################
sim_start_date <- "2020-03-03"
days <- 365*2   #number of days
dt <- 0.01      #time step = 1/100 days
sim_dates <- seq.Date(from=as.Date(sim_start_date), to=as.Date(sim_start_date)+days,by="day")
sim_end_date <- max(sim_dates)
#lockdown dates
lockdown_1_start <- as.Date("2020-03-23")
lockdown_1_end <- as.Date("2020-06-15")
lockdown_2_start <- as.Date("2020-10-31")
lockdown_2_end <- as.Date("2020-12-02")
lockdown_3_start <- as.Date("2021-01-06")
lockdown_3_end <- as.Date("2021-04-12")
sim_dates
sim_end_date
start_days
#lockdown dates
lockdown_1_start <- as.Date("2020-03-23")
lockdown_1_end <- as.Date("2020-06-15")
lockdown_2_start <- as.Date("2020-10-31")
lockdown_2_end <- as.Date("2020-12-02")
lockdown_3_start <- as.Date("2021-01-06")
lockdown_3_end <- as.Date("2021-04-12")
###################
## Interventions ##
##################
start_days <- match(c(lockdown_1_start, lockdown_2_start, lockdown_3_start),sim_dates)
interventions_lengths <- c(days(lockdown_1_end-lockdown_1_start), days(lockdown_2_end-lockdown_2_start), days(lockdown_3_end-lockdown_3_start))
start_days
interventions_lengths <- c(lockdown_1_end-lockdown_1_start), (lockdown_2_end-lockdown_2_start), (lockdown_3_end-lockdown_3_start))
interventions_lengths <- c((lockdown_1_end-lockdown_1_start), (lockdown_2_end-lockdown_2_start), (lockdown_3_end-lockdown_3_start))
intervention_lengths
interventions_lengths
intervention_phase <- numeric(length(time))
###################
## Interventions ##
##################
start_days <- match(c(lockdown_1_start, lockdown_1_end, lockdown_2_start, lockdown_2_end, lockdown_3_start, lockdown_3_end), sim_dates)
durations <- c((lockdown_1_end-lockdown_1_start), c(lockdown_2_start-lockdown_1_end), (lockdown_2_end-lockdown_2_start), (lockdown_3_start-lockdown_2_end),(lockdown_3_end-lockdown_3_start),(sim_end_date-lockdown_3_end))
start_days
durations
sum(durations)
days
vaccine_rates <-  #rates of vaccination by age group and time
#[1] 0.1467292 0.4541867 0.2963081 0.4568307 0.4562605 0.3859425 0.3956995 0.1334783
vaccine_start_dates <- #c()
#age_group=c("80+","75-79","70-74","65-69","60-64","55-59","50-54","under 50"),
#date=c("2020-12-06","2021-01-17","2021-01-17","2021-02-14","2021-02-28","2021-03-07","2021-03-14","2021-03-21"),
vaccine_length <- 7*16
vaccine_rates <-  #rates of vaccination by age group and time
#[1] 0.1467292 0.4541867 0.2963081 0.4568307 0.4562605 0.3859425 0.3956995 0.1334783
vaccine_start_dates <- #c()
#age_group=c("80+","75-79","70-74","65-69","60-64","55-59","50-54","under 50"),
#date=c("2020-12-06","2021-01-17","2021-01-17","2021-02-14","2021-02-28","2021-03-07","2021-03-14","2021-03-21"),
vaccination_length <- 7*16
###########################################
## SARS-CoV-2 Natural history parameters ##
###########################################
R0 <- 4.0                       #Basic reproduction number (in the absense of interventions) Flaxman et al. 2020 Nature. https://doi.org/10.1038/s41586-020-2405-7
sigma_recip <- 4.5              #Average duration of latent period (days)     [From He, X., et al. Temporal dynamics in viral shedding and transmissibility of COVID-19. Nat Med (2020). https://doi.org/10.1038/s41591-020-0869-5]
gamma_recip <- 3.1              #Average duration of infectiousness (days)    [From He, X., et al.]
m <- 4                          #Shape paremeter, latent period
n <- 2                          #Shape parameter, infectious period
p_hosp <- c(0.001, 0.001, 0.003, 0.003, 0.012, 0.012, 0.032, 0.032, 0.049, 0.049, 0.102, 0.102, 0.166, 0.166, 0.26) #From Ferguson et al. Report 9
phi <- c(rep(0.75, 4),rep(0.5,11))  #proportion asymtomatic | infection by age group
crs <- 0.4                          #children relative susceptibility
ari <- 0.5                          #asymtomatic relative infectiousness
susceptibility <- c(rep(crs, 4), rep(1, 11))
######################################
## UK Population & Contact Matrixes ##
######################################
load("data/BBC_contact_matrices_population_vector.RData")
######################################
## UK Population & Contact Matrixes ##
######################################
#set path to current folder
dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(dir)
load("data/BBC_contact_matrices_population_vector.RData")
load("data/uk_population_size_by_age_2018.RData")
